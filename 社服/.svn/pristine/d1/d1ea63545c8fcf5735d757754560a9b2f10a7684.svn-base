// pages/withdraw/wihdraw.js
const app = getApp()
Page({

  /**
   * 页面的初始数据
   */
  data: {
    key: 'account',
    account: 0 ,   // 提现金额
    // cash: '',
    balance: 0,
    state: ''
  },

  /**
   * 生命周期函数--监听页面加载
   */
  // showAction: function () {
  //   wx.showActionSheet
  // }


  // 输入要提现 的钱
  accountChange: function(e) {
  
    let account = +e.detail.value
    this.setData({
      account : account
    })
    // console.log(typeof account)
    let balance = this.data.balance - this.data.account
    // if (value>=0) {
    //   this.setData({
    //     value 
    //   })
    // }
      // this.setData({
      //   account : this.data.account,
      // //  value: value
      // })


  },
  withdraw: function() {
    let key = this.data.key,
        account = String(this.data.account)
        // value = 
      wx.setStorageSync(key, account)
      this.setData({
        key: key,
        account: account
      })
      wx.navigateTo({
        // 拼接字符串
        url: "../withdrawDetail/withdrawDetail?state=" + this.data.state
      })



  },
  showToast:function () {
    wx.showToast({
      title: '敬请期待',
      // icon: 'loading',
      duration: 700,
      mask: true
    })
  },
  onLoad: function(options) {
    // 获取到的余额
    console.log(options.balance)
    let balance = options.balance
    this.setData({
      balance: balance
    })
    // wx.request({
    //   method: "POST",
    //   data: {
    //     openid: wx.getStorageSync("openid").openid,
    //     cash: +options.balance
    //   },
    //   url: app.globalData.url.WITHDRAW,
    //   success: res => {
        
    //     console.log('res：', res)
     
    //     let {
    //       code
    //     } = res.data.data
    //     // console.log(code)
    //     //  获取状态 和 余额
    //     let {
    //       status,
    //       money
    //     } = res.data.data.data
    //     // console.log(status, money)
    //     if (code === 200) {
    //       // 都是字符串
    //       this.setData({
    //         value: money,
    //         state: status
    //       })
    //     }

    //   }
    // })
  },

  /**
   * 生命周期函数--监听页面初次渲染完成
   */
  onReady: function() {

  },

  /**
   * 生命周期函数--监听页面显示
   */
  onShow: function() {
    // console.log(this.data.account)
  },

  /**
   * 生命周期函数--监听页面隐藏
   */
  onHide: function() {
    let resBalance = this.data.balance - this.data.account
    this.setData({
      balance:  resBalance
    })

  },

  /**
   * 生命周期函数--监听页面卸载
   */
  onUnload: function() {

  },

  /**
   * 页面相关事件处理函数--监听用户下拉动作
   */
  onPullDownRefresh: function() {

  },

  /**
   * 页面上拉触底事件的处理函数
   */
  onReachBottom: function() {

  },

  /**
   * 用户点击右上角分享
   */
  onShareAppMessage: function() {

  }
})